import{p as t,a as e,b as n,r as a,o as s,c as o,d as r,w as l,v as u,t as c,e as d,F as i,f,g as p,h,L as m,T as y,i as g,I as _,B as b,R as w,C as j,P as v,j as x,S as C}from"./vendor.a46a5b5f.js";function R(t){const e={p:[],m:[],s:[],z:[]};let n=t;for(;n.length>0;){const t=n.match(/[0-9]*[spzm]/),a=t[0];e[a[a.length-1]]=e[a[a.length-1]].concat(a.substr(0,a.length-1).split("")),n=n.substr(0,t.index)+n.substr(t.index+a.length)}return e}!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(n){const a=new URL(t,location),s=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((n,o)=>{const r=new URL(t,a);if(self[e].moduleMap[r])return n(self[e].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${e}.moduleMap['${r}']=m;`],{type:"text/javascript"}),u=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){o(new Error(`Failed to import: ${t}`)),s(u)},onload(){n(self[e].moduleMap[r]),s(u)}});document.head.appendChild(u)})),self[e].moduleMap={}}}("/mahjong/assets/");const k={m:["🀇","🀈","🀉","🀊","🀋","🀌","🀍","🀎","🀏"],p:["🀙","🀚","🀛","🀜","🀝","🀞","🀟","🀠","🀡"],s:["🀐","🀑","🀒","🀓","🀔","🀕","🀖","🀗","🀘"],z:["🀀","🀁","🀂","🀃","🀆","🀅","🀄","🀫","🀪"]};function z(t){let e=9,n=0,a=0,s=0;const o=(t,e=!1)=>{let o=[0,0,0],r=[0,0,0];const l=[...t];let u=0,c=0,d=0;for(let n=0;n<9;n++)if(0!==l[n]&&void 0!==l[n]&&(l[n]>=3&&(l[n]-=3,u++),l[n]>0)){if(e)continue;l[n+1]>0&&l[n+2]>0&&(l[n]--,l[n+1]--,l[n+2]--,u++),l[n]>0&&l[n+1]>0&&l[n+2]>0&&(l[n]--,l[n+1]--,l[n+2]--,u++)}for(let n=0;n<9;n++)0!==l[n]&&void 0!==l[n]&&(2!==l[n]?e||(l[n+1]>0&&(l[n]--,l[n+1]--,c++),l[n+2]>0&&(l[n]--,l[n+2]--,c++)):(l[n]-=2,c++));d+=l.reduce(((t,e)=>t+e)),o=[u,c,d];const i=[...t];u=0,c=0,d=0;for(let n=0;n<9;n++)0!==i[n]&&void 0!==i[n]&&(e||(i[n]>=2&&i[n+1]>=2&&i[n+2]>=2&&(i[n]-=2,i[n+1]-=2,i[n+2]-=2,u+=2),i[n]>=2&&i[n+1]>=2&&i[n+2]>=2&&(i[n]-=2,i[n+1]-=2,i[n+2]-=2,u+=2)),3!==i[n]&&4!==i[n]||(i[n]-=3,u++),2===i[n]&&(i[n]-=2,c++),e||(i[n]>0&&i[n+1]>0&&i[n+2]>0&&(i[n]--,i[n+1]--,i[n+2]--,u++),i[n]>0&&i[n+1]>0&&(i[n]--,i[n+1]--,c++),i[n]>0&&i[n+2]>0&&(i[n]--,i[n+2]--,c++)));d+=i.reduce(((t,e)=>t+e)),r=[u,c,d];const f=o>=r?o:r;n+=f[0],a+=f[1],s+=f[2]};return o(t[0]),o(t[1]),o(t[2]),o(t[3],!0),(()=>{let t=-1;for(;n<4;)a&&s?(a--,s--,n++,t++):!a||s?!a&&s&&(s-=2,n++,t+=2):(a--,s++,n++,t++);s>0&&t++,e=t<e?t:e,n=a=s=0})(),e}function I(t){const e=function(t){const e=t[0].reduce(((t,e)=>t+e))+t[1].reduce(((t,e)=>t+e))+t[2].reduce(((t,e)=>t+e))+t[3].reduce(((t,e)=>t+e));if(e<13||e>14)return-2;const n=[...t[0],...t[1],...t[2],...t[3]];let a=0,s=0;for(let o=0;o<34;o++)n[o]>=2&&a++,1===n[o]&&s++;return a+s>=7?6-a:6-a+(7-a-s)}(t),n=function(t){const e=t[0].reduce(((t,e)=>t+e))+t[1].reduce(((t,e)=>t+e))+t[2].reduce(((t,e)=>t+e))+t[3].reduce(((t,e)=>t+e));if(e<13||e>14)return-2;const n=[t[0][0],t[0][8],t[1][0],t[1][8],t[2][0],t[2][8],...t[3]];let a=0,s=0;for(let o=0;o<13;o++)n[o]&&a++,n[o]>1&&(s=1);return 13-a-s}(t);return-2===e||-2===n?z(t):Math.min(z(t),e,n)}function M(t,e,n){const a=I(t);t[e][n]--;const s=[];for(let o=0;o<4;o++)for(let r=0;r<t[o].length;r++){t[o][r]++;const l=I(t);if((o!==e||r!==n)&&l<a){const t={i:o,j:r};s.push(t)}t[o][r]--}return t[e][n]++,s}function S(t){const e=function(t){const e=new Array(9).fill(0),n=new Array(9).fill(0),a=new Array(9).fill(0),s=new Array(7).fill(0);let o;for(let r=0;r<t.m.length;r++)o=parseInt(t.m[r]),e[--o]++;for(let r=0;r<t.p.length;r++)o=parseInt(t.p[r]),n[--o]++;for(let r=0;r<t.s.length;r++)o=parseInt(t.s[r]),a[--o]++;for(let r=0;r<t.z.length;r++)o=parseInt(t.z[r]),s[--o]++;return[[...e],[...n],[...a],[...s]]}(R(t)),n=I(e),a=function(t){const e=[];for(let n=0;n<4;n++)for(let a=0;a<t[n].length;a++)t[n][a]>0&&e.push(M(t,n,a));return e}(e);return{syanten:n,kariyou:function(t,e){const n=new Map,a=L(t);let s=[];for(let o=0;o<e.length;o++)e[o].length>0&&(s=L(e[o]),n.set(a[o],s));return n}(function(t){const e=[];for(let n=0;n<4;n++)for(let a=0;a<t[n].length;a++)if(t[n][a]>0){const t={i:n,j:a};e.push(t)}return e}(e),a)}}function L(t){const e=[];let n="";for(let a=0;a<t.length;a++)0===t[a].i&&(n=++t[a].j+"m",e.push(n)),1===t[a].i&&(n=++t[a].j+"p",e.push(n)),2===t[a].i&&(n=++t[a].j+"s",e.push(n)),3===t[a].i&&(n=++t[a].j+"z",e.push(n));return e}function U(t){try{const e=R(t.replace(/0/,"5")),n=[];for(const t in e)n.push(...e[t].map((e=>k[t][e-1])));return n}catch(e){return[]}}const A={data:()=>({handCards:"",Syanten:0,calcRes:[],inputed:!1}),methods:{showCards(){if(this.handCards.length<=0||!function(t){try{const e=R(t.replace(/0/,"5")),n=e.m.length+e.p.length+e.s.length+e.z.length;return!(n<13||n>14)}catch(e){return!1}}(this.handCards))return void n.error("無効入力");const{syanten:t,kariyou:e}=S(this.handCards);this.Syanten=t;const a=[];e.forEach(((t,e)=>{a.push({da:U(e)[0],daRaw:e,mo:t.map(U).map((t=>t[0])),moRaw:t})})),this.calcRes=a,this.inputed=!0},discard(t,e){const n=t.daRaw,a=t.moRaw[e],s=R(this.handCards);s[n[1]]=s[n[1]].filter((t=>t!==n[0])),s[a[1]].push(a[0]),this.handCards=function(t){let e="";for(const n in t)e+=t[n].sort().join("")+n;return e}(s),this.showCards()}},computed:{handCardsImg(){return U(this.handCards)}}},P=p("data-v-6b45234b");t("data-v-6b45234b");const $=d(" - m=萬子, p=筒子, s=索子, z=字牌, 0=赤 - 一般形=４面子１雀頭 / 標準形=一般形＋七対形＋国士形 - ツモはその時点で使用していない牌をランダムに選択します - 有効牌をクリックすると打牌後にその牌をツモ牌として表示します - (n*3+2)枚で開始：(n*3+2)枚目をツモ牌として表示 - (n*3+1)枚で開始：ツモはページのロード時に毎回変化 - 和了役の判定はありません - 暗槓はできません "),B=d("新規"),E=d("手牌："),F={class:"tiles"},O={class:"tiles"};e();const q=P(((t,e,n,p,h,m)=>{const y=a("a-button"),g=a("a-tooltip"),_=a("a-input-search"),b=a("a-form-item"),w=a("a-form"),j=a("a-col"),v=a("a-row"),x=a("a-table-column"),C=a("a-table-column-group"),R=a("a-table");return s(),o(v,{type:"flex",justify:"center"},{default:P((()=>[r(j,{span:24},{default:P((()=>[r(j,{span:24},{default:P((()=>[r(v,{type:"flex",justify:"center"},{default:P((()=>[r(j,{span:12},{default:P((()=>[r(w,null,{default:P((()=>[r(b,{label:"Please input your hand cards:"},{default:P((()=>[r(_,{value:h.handCards,"onUpdate:value":e[1]||(e[1]=t=>h.handCards=t),placeholder:"手牌",size:"large",onSearch:m.showCards},{enterButton:P((()=>[r(g,null,{title:P((()=>[$])),default:P((()=>[r(y,{type:"link",ghost:""},{default:P((()=>[B])),_:1})])),_:1})])),_:1},8,["value","onSearch"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),r(j,{span:24},{default:P((()=>[r(v,{type:"flex",justify:"center"},{default:P((()=>[r(j,{span:12},{default:P((()=>[l(r(R,{"data-source":h.calcRes,rowKey:(t,e)=>e,bordered:"",style:{width:"100%"},pagination:{pageSize:50},scroll:{y:240}},{title:P((()=>[r("span",null,[E,r("span",F,c(m.handCardsImg.join("")),1),d("("+c(0===h.Syanten?"聴牌":`${h.Syanten}向聴`)+")",1)])])),default:P((()=>[r(C,{title:"標準形(七対国士を含む)の計算結果:"},{default:P((()=>[r(x,{key:"da","data-index":"da",title:"打"},{default:P((({text:t})=>[r("span",O,c(t),1)])),_:1}),r(x,{key:"mo",title:"摸","data-index":"mo"},{default:P((({text:t,record:e})=>[r("a",null,[(s(!0),o(i,null,f(t,((t,n)=>(s(),o("span",{key:t,onClick:t=>m.discard(e,n),class:"tiles"},c(t),9,["onClick"])))),128))])])),_:1})])),_:1})])),_:1},8,["data-source","rowKey"]),[[u,h.inputed]])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}));A.render=q,A.__scopeId="data-v-6b45234b";const H={name:"App",components:{Home:A}},K=p("data-v-73d3a264");t("data-v-73d3a264");const T={class:"layout"},D=r("a",{href:"https://github.com/paxyqi/mahjong"},[r("div",{class:"imgBox"},[r("img",{alt:"Mahjong pic",width:"300",height:"400",src:"/mahjong/assets/mahjong.0014c54b.png",style:{transform:"scale(0.7)"}})])],-1),G=r("a",{href:"https://github.com/paxyqi",style:{"text-decoration":"none",color:"black"}},[r("strong",null,"Pixy")],-1),J=d(" ©2021 ");e();const N=K(((t,e,n,l,u,c)=>{const d=a("a-page-header"),i=a("a-layout-header"),f=a("a-col"),p=a("a-row"),h=a("Home"),m=a("a-layout-content"),y=a("a-layout-footer"),g=a("a-layout");return s(),o("div",T,[r(g,null,{default:K((()=>[r(i,{style:{padding:"0"},class:"header"},{default:K((()=>[r(d,{style:{"background-color":"#f5f5f5",width:"100%"},title:"麻雀牌理","sub-title":"ようこそPixyちゃんの牌理ウェブサイト!"})])),_:1}),r(m,{class:"content"},{default:K((()=>[r(p,null,{default:K((()=>[r(f,{span:24},{default:K((()=>[r(p,{type:"flex",justify:"center"},{default:K((()=>[r(f,{span:24},{default:K((()=>[D])),_:1})])),_:1}),r(p,{type:"flex",justify:"center"},{default:K((()=>[r(f,{span:24},{default:K((()=>[r(h)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),r(y,{style:{"text-align":"center"},class:"footer"},{default:K((()=>[G,J])),_:1})])),_:1})])}));H.render=N,H.__scopeId="data-v-73d3a264",h(H).use(m).use(y).use(g).use(_).use(b).use(w).use(j).use(v).use(x).use(C).mount("#app");
